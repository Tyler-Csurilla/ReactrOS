.desktop-icon {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    width: var(--icon-width);
    height: var(--icon-height);
    cursor: pointer;
    user-select: none;
    padding: 4px;
    transition:
        background-color 0.15s ease,
        border 0.15s ease,
        box-shadow 0.15s ease,
        opacity 0.15s ease-in-out;
    color: var(--icon-text-color);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

/* Desktop Icon State Classes */
.desktop-icon.dragging {
    opacity: 0.7;
    transform: rotate(1deg);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.desktop-icon.drag-over {
    background-color: var(--icon-hover-bg);
    outline: 1px dashed var(--accent-light);
    box-shadow: 0 0 8px var(--icon-focus-glow);
}

.desktop-icon.drag-end {
    animation: dragEndBounce 0.3s ease-out;
}

@keyframes dragEndBounce {
    0% {
        transform: scale(1.1);
    }
    50% {
        transform: scale(0.95);
    }
    100% {
        transform: scale(1);
    }
}

.desktop-icon.active {
    background-color: var(--icon-active-bg);
    outline: 1px solid var(--icon-selected-border);
    box-shadow: 0 0 6px var(--icon-focus-glow);
}

.desktop-icon.hovered {
    background-color: var(--icon-hover-bg);
    outline: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.desktop-icon.focused {
    background-color: var(--icon-selected-bg);
    outline: 1px solid var(--icon-selected-border);
    box-shadow: 0 0 8px var(--icon-focus-glow);
}

.desktop-icon.double-clicked {
    background-color: var(--selection-bg);
    outline: 1px solid var(--accent-dark);
    box-shadow: 0 0 10px rgba(55, 65, 81, 0.4);
    animation: doubleClickPulse 0.2s ease-out;
}

@keyframes doubleClickPulse {
    0% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.025);
    }
    100% {
        transform: scale(1);
    }
}

.desktop-icon.selected-alt {
    background-color: rgba(139, 195, 74, 0.2);
    outline: 1px solid #8bc34a;
    box-shadow: 0 0 6px rgba(139, 195, 74, 0.3);
}

.desktop-icon.context-menu {
    background-color: rgba(233, 30, 99, 0.2);
    outline: 1px solid #e91e63;
    box-shadow: 0 0 6px rgba(233, 30, 99, 0.3);
}

.desktop-icon.disabled {
    background-color: rgba(128, 128, 128, 0.2);
    outline: 1px solid #808080;
    pointer-events: none;
    opacity: 0.5;
    filter: grayscale(50%);
}
.desktop-icon:hover {
    background-color: var(--icon-hover-bg);
    outline: 1px solid rgba(255, 255, 255, 0.4);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}
.desktop-icon img {
    width: auto;
    max-width: calc(var(--icon-width) - 16px);
    max-height: var(--icon-content-height);
    height: auto;
    pointer-events: none;
    object-fit: contain;
    padding: 2px;
    filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
}

.desktop-icon:hover img {
    background: rgba(255, 255, 255, 0.05);
}

.desktop-icon .icon {
    font-size: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    height: var(--icon-content-height);
    width: 100%;
    margin-bottom: 4px;
    filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
}

.desktop-icon .icon svg {
    width: auto;
    height: auto;
    max-width: 40px;
    max-height: 40px;
    filter: drop-shadow(0 1px 1px rgba(0, 0, 0, 0.5));
}

.desktop-icon .icon span {
    font-size: 36px;
    line-height: 1;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

.desktop-icon .label {
    font-size: 11px;
    color: var(--icon-text-color);
    text-align: center;
    text-shadow: var(--icon-text-shadow);
    line-height: 1.1;
    word-wrap: break-word;
    max-width: 100%;
    height: calc(var(--icon-height) - var(--icon-content-height) - 8px);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    padding: 0 2px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-weight: 400;
}

.react-draggable-dragging {
    cursor: grabbing !important;
    border: 1px dashed rgba(107, 114, 128, 0.8) !important;
    background-color: rgba(107, 114, 128, 0.1) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
    transform: rotate(1deg) !important;
    z-index: 1000;
}

.react-draggable-dragging .icon {
    opacity: 0.8;
}

.react-draggable-dragging .label {
    opacity: 0.8;
}

.desktop-icon.selected {
    background: linear-gradient(
        to bottom,
        rgba(107, 114, 128, 0.4),
        rgba(75, 85, 99, 0.4)
    );
    outline: 1px solid var(--selection-border);
}

/* Enhanced Icon Effects */
.desktop-icon:focus {
    outline: none;
    background-color: var(--icon-selected-bg);
    outline: 1px solid var(--icon-selected-border);
    box-shadow: 0 0 8px var(--icon-focus-glow);
}

.desktop-icon:focus-visible {
    outline: 2px solid var(--accent-light);
    outline-offset: 1px;
}

/* Active press state */
.desktop-icon:active:not(.react-draggable-dragging) {
    transform: translateY(0px);
    background: linear-gradient(
        to bottom,
        rgba(107, 114, 128, 0.2),
        rgba(107, 114, 128, 0.3)
    );
    outline: 1px solid var(--accent-dark);
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
}

/* Keyboard navigation */
.desktop-icon[tabindex]:focus {
    background-color: var(--icon-selected-bg);
    outline: 1px solid var(--icon-selected-border);
}

.desktop-icon.double-clicked .icon {
    animation: iconBounce 0.3s ease-out;
}

@keyframes iconBounce {
    0% {
        transform: scale(1);
    }
    25% {
        transform: scale(1.1);
    }
    50% {
        transform: scale(0.95);
    }
    75% {
        transform: scale(1.02);
    }
    100% {
        transform: scale(1);
    }
}
